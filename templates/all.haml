!!!
%html{:lang => "en"}
  %head
    %meta{:charset => "utf-8"}/
    %meta{:content => "IE=edge", "http-equiv" => "X-UA-Compatible"}/
    %meta{:content => "width=device-width, initial-scale=1", :name => "viewport"}/
    %title CDDA Issue Voter
    %link{:href => "/css/bootstrap.css", :rel => "stylesheet"}/
    %link{:href => "/css/bootstrap-theme.css", :rel => "stylesheet"}/
    %link{:href => "/css/main.css", :rel => "stylesheet"}/
    %script{:src => "/js/bootstrap.js"}
  %body
    .navbar.navbar-inverse.navbar-fixed-top{:role => "navigation"}
      .container
        .navbar-header
          %button.navbar-toggle{"data-target" => ".navbar-collapse", "data-toggle" => "collapse", :type => "button"}
            %span.sr-only Toggle navigation
            %span.icon-bar
            %span.icon-bar
            %span.icon-bar
          %a.navbar-brand{:href => "#"} CDDA IV
        .collapse.navbar-collapse
          %ul.nav.navbar-nav
            %li.active
              %a{:href => '/all'} All
            %li
              %a{:href => '/top'} Top
            %li
              %a{:href => '/bottom'} Bottom
            %li
              %a{:href => '/closed'} Closed
          %ul.nav.navbar-nav.navbar-right
            - if @user
              %li
                %a{:href => "/user/#{@user.login}"}= @user.login
              %li
                %a{:href => '/logout'} Logout
            %li
              %a{:href => '/about'} About
    .container
      %h3 All open issues, by date
      %table.table.table-striped
        %tr
          %th Score
          %th Vote
          %th Title
          %th Opened
        - @issues.each_with_index do |i, n|
          %tr
            %td= i.score
            %td
              - if @user
                - if v = @votes[n]
                  - if v.dir == :up
                    %a{:href => "/vote/up/#{i.id}/all", :style => 'color: red'}
                      %span.glyphicon.glyphicon-arrow-up
                  - else
                    %a{:href => "/vote/up/#{i.id}/all"}
                      %span.glyphicon.glyphicon-arrow-up
                  - if v.dir == :down
                    %a{:href => "/vote/down/#{i.id}/all", :style => 'color: red'}
                      %span.glyphicon.glyphicon-arrow-down
                  - else
                    %a{:href => "/vote/down/#{i.id}/all"}
                      %span.glyphicon.glyphicon-arrow-down
                - else
                  %a{:href => "/vote/up/#{i.id}/all"}
                    %span.glyphicon.glyphicon-arrow-up
                  %a{:href => "/vote/down/#{i.id}/all"}
                    %span.glyphicon.glyphicon-arrow-down
              - else
                %a{:href => "#login"}
                  %span.glyphicon.glyphicon-ban-circle
            %td= i.title
            %td= i.from.strftime('%Y-%m-%d %H:%M')
    - unless @user
      .container
        %a{:name => 'login'}
        %h4 You're not logged in. That means no voting for you.
        %div.row
          %div.col-md-6
            %div.panel.panel-default
              %div.panel-heading Login here
              %div.panel-body
                %form{:role => "form", :action => "/login", :method => "post"}
                  .form-group
                    %input.form-control{:name => "login", :type => "text", :placeholder => "Login"}
                  .form-group
                    %input.form-control{:name => "pass", :type => "password", :placeholder => "Password"}
                  %input{:name => "source", :type => "hidden", :value => "/all"}
                  %button.btn.btn-success{:type => "submit"} Login
          %div.col-md-6
            %div.panel.panel-default
              %div.panel-heading Or register here
              %div.panel-body
                %form{:role => "form", :action => "/register", :method => "post"}
                  .form-group
                    %input.form-control{:name => "login", :type => "text", :placeholder => "Login"}
                  .form-group
                    %input.form-control{:name => "passa", :type => "password", :placeholder => "Password"}
                  .form-group
                    %input.form-control{:name => "passb", :type => "password", :placeholder => "Password again"}
                  .form-group
                    %input.form-control{:name => "email", :type => "email", :placeholder => "E-Mail"}
                  %input{:name => "source", :type => "hidden", :value => "/all"}
                  %button.btn.btn-success{:type => "submit"} Register
    .container
      .footer
        &copy; Copyright 2015 Piotr S. Staszewski
